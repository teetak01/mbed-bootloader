{
    "requires": ["bare-metal",
                 "rtos-api",
                 "update-client",
                 "storage",
                 "storage_filesystem",
                 "SecureStore",
                 "storage_tdb_internal",
                 "mbed-bootloader",
                 "mbedtls",
                 "system-storage",
                 "filesystem",
                 "filesystemstore",
                 "littlefs",
                 "fat_chan",
                 "spif",
                 "qspif",
                 "sd",
                 "flashiap-block-device",
                 "direct-access-devicekey",
                 "tdbstore",
                 "kv-config",
                 "kv-global-api",
                 "kv-map",
                 "device_key"
    ],
    "config": {
        "documentation": {
            "psa-options": [
                    "The configuration for PSA boards is:",
                    "- Firmware storage is on an external SD card block device",
                    "- Root of Trust is obtain from internal flash in kvstore",
                    "The flash regions are as follows:",
                    "1. Bootloader - 32KiB-40KiB from the beginning of flash depends on the psa target",
                    "2. Active App Metadata Header - (1KiB/2KiB) from the end of KVSTORE",
                    "3. Active App - From end of header to the end of flash",
                    "4. KVSTORE - 8K/15KiB flash at the flash end. the size depends on flash program size",
                    "+--------------------------+",
                    "|                          |",
                    "|         KVSTORE          |",
                    "|                          |",
                    "+--------------------------+ <-+ storage_tdb_internal.internal_base_address",
                    "|                          |",
                    "|        Free space        |",
                    "|                          |",
                    "+--------------------------+",
                    "|                          |",
                    "|                          |",
                    "|                          |",
                    "|        Active App        |",
                    "|                          |",
                    "|                          |",
                    "|                          |",
                    "+--------------------------+ <-+ mbed-bootloader.application-start-address",
                    "|Active App Metadata Header|",
                    "+--------------------------+ <-+ update-client.application-details",
                    "|                          |",
                    "|        Bootloader        |",
                    "|                          |",
                    "+--------------------------+ <-+ 0",
                    "Firmware Candidate Storage is on external SD Card at an offset of 64 MiB.",
                    "The storage size is the size of the maximum application size (i.e. Active",
                    "Application region size) multiplied by the number of storage-locations.",
                    "(storage-locations is set to 1 in this configuration)"
            ]
        }
    },
    "macros": [
        "ARM_UC_USE_PAL_BLOCKDEVICE=1",
        "MBED_CLOUD_CLIENT_UPDATE_STORAGE=ARM_UCP_FLASHIAP_BLOCKDEVICE",
        "MBED_BOOTLOADER_ACTIVE_HEADER_REGION_SIZE=1024"
    ],
    "target_overrides": {
        "*": {
            "target.default_lib"                       : "small",
            "platform.use-mpu"                         : false,
            "platform.default-serial-baud-rate"        : 115200,
            "update-client.storage-address"            : "(1024*1024*64)",
            "update-client.storage-size"               : "((MBED_ROM_START + MBED_ROM_SIZE - MBED_CONF_MBED_BOOTLOADER_APPLICATION_START_ADDRESS) * MBED_CONF_UPDATE_CLIENT_STORAGE_LOCATIONS)",
            "update-client.storage-locations"          : 1,
            "update-client.firmware-header-version"    : "2",
            "target.restrict_size"                     : "0x8000",
            "target.components_add"                    : ["SD"],
            "sd.CRC_ENABLED"                           : 0,
            "storage.storage_type"                     : "FILESYSTEM",
            "storage_filesystem.internal_base_address" : "(MBED_ROM_START + MBED_BOOTLOADER_SIZE)",
            "update-client.application-details"        : "(MBED_CONF_STORAGE_FILESYSTEM_INTERNAL_BASE_ADDRESS + MBED_CONF_STORAGE_FILESYSTEM_RBP_INTERNAL_SIZE)",
            "mbed-bootloader.application-start-address": "(MBED_CONF_UPDATE_CLIENT_APPLICATION_DETAILS + MBED_BOOTLOADER_ACTIVE_HEADER_REGION_SIZE)",
            "target.extra_labels_remove"               : [ "WICED", "CORDIO", "PSA", "MBED_SPM" ]
        },
        "LPC55S69_NS": {
            "target.components_remove"                     : [ "SPM_MAILBOX" ],
            "target.macros_remove"                         : ["MBED_FAULT_HANDLER_DISABLED"],
            "storage_filesystem.internal_base_address"     : "0x94000",
            "storage_filesystem.rbp_internal_size"         : "(15*1024)",
            "update-client.application-details"            : "(MBED_ROM_START + MBED_BOOTLOADER_SIZE)",
            "mbed-bootloader.default-max-application-size" : "(MBED_ROM_START + MBED_ROM_SIZE - MBED_CONF_MBED_BOOTLOADER_APPLICATION_START_ADDRESS - MBED_CONF_STORAGE_FILESYSTEM_RBP_INTERNAL_SIZE)",
            "target.secure_image_filename"                 : null
        }
    }
}
